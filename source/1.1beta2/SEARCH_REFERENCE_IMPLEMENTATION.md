# üìã –ü–æ–¥—Ä–æ–±–Ω–æ–µ –æ–±—ä—è—Å–Ω–µ–Ω–∏–µ: –†–µ–∞–ª–∏–∑–∞—Ü–∏—è –ø–æ–∏—Å–∫–∞ –∏ –≤—ã–¥–µ–ª–µ–Ω–∏—è –≤ –∫–æ–ª–æ–Ω–∫–µ —Ä–µ—Ñ–µ—Ä–µ–Ω—Å–∞

## üéØ –ü—Ä–æ–±–ª–µ–º–∞

–ü–æ–∏—Å–∫ —Ç–µ–∫—Å—Ç–∞ —Ä–∞–±–æ—Ç–∞–ª –≤–µ–∑–¥–µ (–æ—Ä–∏–≥–∏–Ω–∞–ª, —Ä–µ–¥–∞–∫—Ç–æ—Ä, –∞—É–¥–∏–æ—Ñ–∞–π–ª—ã), –Ω–æ **–∫–æ–ª–æ–Ω–∫–∞ —Ä–µ—Ñ–µ—Ä–µ–Ω—Å–∞ –Ω–µ –≤—ã–¥–µ–ª—è–ª–∞ –Ω–∞–π–¥–µ–Ω–Ω—ã–π —Ç–µ–∫—Å—Ç**. –ü—Ä–∏ —ç—Ç–æ–º –ø–æ–∏—Å–∫ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏–ª, –Ω–æ –≤—ã–¥–µ–ª–µ–Ω–∏–µ –Ω–µ –ø–æ—è–≤–ª—è–ª–æ—Å—å.

---

## üîç –ê–Ω–∞–ª–∏–∑ –∏ –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞ (–≠—Ç–∞–ø 1)

### –ß—Ç–æ –±—ã–ª–æ –æ–±–Ω–∞—Ä—É–∂–µ–Ω–æ:

1. **–õ–æ–≥–∏—á–µ—Å–∫–∞—è –æ—à–∏–±–∫–∞ –≤ —á–µ–∫–±–æ–∫—Å–∞—Ö –ø–æ–∏—Å–∫–∞**
   ```python
   # ‚ùå –ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω–æ (–±—ã–ª–æ)
   search_reference = getattr(self.settings_window, 'cb_search_reference', None) and self.settings_window.cb_search_reference.isChecked() or True
   
   # –ü—Ä–æ–±–ª–µ–º–∞: –ò–∑-–∑–∞ –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç–∞ –æ–ø–µ—Ä–∞—Ç–æ—Ä–æ–≤ `and`/`or`, —ç—Ç–æ –í–°–ï–ì–î–ê –≤–æ–∑–≤—Ä–∞—â–∞–ª–æ True
   # –õ–æ–≥–∏–∫–∞: (A and B) or True = True (–≤—Å–µ–≥–¥–∞!)
   ```

   ```python
   # ‚úÖ –ü—Ä–∞–≤–∏–ª—å–Ω–æ (—Å—Ç–∞–ª–æ)
   cb_ref = getattr(self.settings_window, 'cb_search_reference', None)
   search_reference = cb_ref.isChecked() if cb_ref else True
   ```

   **–í—ã–≤–æ–¥:** –í—Å–µ–≥–¥–∞ –ø—Ä–æ–≤–µ—Ä—è–π—Ç–µ –ª–æ–≥–∏–∫—É `and`/`or` –ø—Ä–∏ —Ä–∞–±–æ—Ç–µ —Å –±—É–ª–µ–≤—ã–º–∏ –∑–Ω–∞—á–µ–Ω–∏—è–º–∏!

---

## üõ†Ô∏è –ü—Ä–æ–±–ª–µ–º–∞ —Å –≤—ã–¥–µ–ª–µ–Ω–∏–µ–º (–≠—Ç–∞–ø 2)

### –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ —Å–∏—Å—Ç–µ–º—ã:

–ü—Ä–æ–≥—Ä–∞–º–º–∞ –∏–º–µ–µ—Ç **—Ç—Ä–∏ –Ω–µ–∑–∞–≤–∏—Å–∏–º—ã—Ö —Å—Ç–æ–ª–±—Ü–∞** –≤ –ø—Ä–µ–≤—å—é:
1. **Reference** (read-only, `is_reference=True`)
2. **Editor** (read-write, `is_reference=False`)
3. **Metadata** (–Ω–µ —É—á–∞—Å—Ç–≤—É–µ—Ç –≤ –ø–æ–∏—Å–∫–µ)

–ö–∞–∂–¥—ã–π —Å—Ç–æ–ª–±–µ—Ü —Å–æ–¥–µ—Ä–∂–∏—Ç **PreviewTextEdit** –≤–∏–¥–∂–µ—Ç—ã.

### –ö–ª—é—á–µ–≤–∞—è –æ—à–∏–±–∫–∞ –≤ –ª–æ–≥–∏–∫–µ –≤—ã–¥–µ–ª–µ–Ω–∏—è:

```python
# ‚ùå –ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω–æ (–±—ã–ª–æ)
if match_type == 'text_original' and edit.isReadOnly():
    should_highlight = True

# –ü—Ä–æ–±–ª–µ–º–∞: 
# 1. –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–ª–∞—Å—å —Ñ—É–Ω–∫—Ü–∏—è isReadOnly() –±–µ–∑ –≥–∞—Ä–∞–Ω—Ç–∏–∏ –µ—ë –ø—Ä–∞–≤–∏–ª—å–Ω–æ–π —Ä–∞–±–æ—Ç—ã
# 2. –õ–æ–≥–∏–∫–∞ –Ω–µ —É—á–∏—Ç—ã–≤–∞–ª–∞ —Å—Ç—Ä—É–∫—Ç—É—Ä—É –¥–∞–Ω–Ω—ã—Ö reference
```

### –ö—Ä–∏—Ç–∏—á–µ—Å–∫–æ–µ –æ—Ç–∫—Ä—ã—Ç–∏–µ:

–ü—Ä–∏ —Å–æ–∑–¥–∞–Ω–∏–∏ PreviewTextEdit **–¥–ª—è reference-–∫–æ–ª–æ–Ω–∫–∏** –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç –Ω–∞—Å–ª–µ–¥–æ–≤–∞–Ω–∏–µ:

```python
# –°—Ç—Ä–æ–∫–∞ 5598 –≤ main.py
orig_edit = PreviewTextEdit(-1, ref_text, read_only=True, parent=self)
# ‚òùÔ∏è –ò–ù–î–ï–ö–° = -1 –¥–ª—è –æ—Ç–¥–µ–ª—å–Ω—ã—Ö —Ñ–∞–π–ª–æ–≤ reference!

# –°—Ç—Ä–æ–∫–∞ 5608
orig_edit = PreviewTextEdit(idx, ref_text, read_only=True, parent=self)
# ‚òùÔ∏è –ò–ù–î–ï–ö–° = idx –¥–ª—è fallback —Å–ª—É—á–∞–µ–≤
```

**–ü—Ä–æ–±–ª–µ–º–∞:** –ë—ã–ª–æ —É—Å–ª–æ–≤–∏–µ –ø—Ä–æ–≤–µ—Ä–∫–∏:
```python
if edit_index == line_index:  # ‚ùå –ù–µ —Ä–∞–±–æ—Ç–∞–µ—Ç, –∫–æ–≥–¥–∞ edit_index = -1
    should_highlight = True
```

---

## üí° –†–µ—à–µ–Ω–∏–µ (–≠—Ç–∞–ø 3)

### –®–∞–≥ 1: –î–æ–±–∞–≤–∏—Ç—å —è–≤–Ω—ã–π –º–∞—Ä–∫–µ—Ä —Ç–∏–ø–∞ —Ä–µ–¥–∞–∫—Ç–æ—Ä–∞

–í–º–µ—Å—Ç–æ –ø–æ–ª–∞–≥–∞–Ω–∏—è –Ω–∞ `isReadOnly()`, –¥–æ–±–∞–≤–∏–ª–∏ —è–≤–Ω—ã–π –∞—Ç—Ä–∏–±—É—Ç –ø—Ä–∏ —Å–æ–∑–¥–∞–Ω–∏–∏:

```python
# –ü—Ä–∏ —Å–æ–∑–¥–∞–Ω–∏–∏ reference —Ä–µ–¥–∞–∫—Ç–æ—Ä–∞
orig_edit = PreviewTextEdit(-1, ref_text, read_only=True, parent=self)
orig_edit.is_reference = True  # ‚úÖ –Ø–≤–Ω—ã–π –º–∞—Ä–∫–µ—Ä

# –ü—Ä–∏ —Å–æ–∑–¥–∞–Ω–∏–∏ editor —Ä–µ–¥–∞–∫—Ç–æ—Ä–∞
trans_edit = PreviewTextEdit(idx, t_text, read_only=False, parent=self)
trans_edit.is_reference = False  # ‚úÖ –Ø–≤–Ω—ã–π –º–∞—Ä–∫–µ—Ä
```

**–ü–æ—á–µ–º—É —ç—Ç–æ —Ä–∞–±–æ—Ç–∞–µ—Ç:**
- –Ø–≤–Ω—ã–π –º–∞—Ä–∫–µ—Ä –Ω–∞–¥—ë–∂–Ω–µ–µ, —á–µ–º `isReadOnly()`
- –ï—Å–ª–∏ –≤–æ–æ–±—â–µ –∑–∞–±—ã—Ç—å –ø–µ—Ä–µ–¥–∞—Ç—å `read_only`, —Å–≤–æ–π—Å—Ç–≤–æ –≤—Å—ë —Ä–∞–≤–Ω–æ –±—É–¥–µ—Ç
- –ú–∞—Ä–∫–µ—Ä –º–æ–∂–Ω–æ –ª–µ–≥–∫–æ –æ—Ç—Å–ª–µ–¥–∏—Ç—å —á–µ—Ä–µ–∑ –ø—Ä–∏–≤–∞—Ç–Ω—ã–π –∞—Ç—Ä–∏–±—É—Ç

### –®–∞–≥ 2: –û–±—Ä–∞–±–æ—Ç–∞—Ç—å –≤—Å–µ —Ç–∏–ø—ã —Å–æ–≤–ø–∞–¥–µ–Ω–∏–π

```python
# –û–ø—Ä–µ–¥–µ–ª—è–µ–º, –∫–∞–∫–æ–π —Ä–µ–¥–∞–∫—Ç–æ—Ä –≤—ã–¥–µ–ª—è—Ç—å, –≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç —Ç–∏–ø–∞ —Å–æ–≤–ø–∞–¥–µ–Ω–∏—è
if match_type in ('text_original', 'text_reference'):
    # –û–±–∞ —Ç–∏–ø–∞ –≤—ã–¥–µ–ª—è—é—Ç –≤ read-only (reference) –∫–æ–ª–æ–Ω–∫–µ
    should_search = is_reference_edit and (edit_index == line_index or edit_index == -1)

elif match_type == 'text_translated':
    # –¢–æ–ª—å–∫–æ editor –∫–æ–ª–æ–Ω–∫–∞
    should_search = not is_reference_edit and edit_index == line_index
```

**–ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏–π –º–æ–º–µ–Ω—Ç:** 
- `edit_index == line_index or edit_index == -1` —Ä–µ—à–∞–µ—Ç –ø—Ä–æ–±–ª–µ–º—É —Å –∏–Ω–¥–µ–∫—Å–∞–º–∏ reference
- `text_reference` –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç —Å–æ–≤–ø–∞–¥–µ–Ω–∏–µ –≤ –æ—Ç–¥–µ–ª—å–Ω–æ–º —Ñ–∞–π–ª–µ reference
- `text_original` –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç —Å–æ–≤–ø–∞–¥–µ–Ω–∏–µ –≤ –æ—Å–Ω–æ–≤–Ω–æ–º display_text

### –®–∞–≥ 3: –õ–æ–≥–∏–∫–∞ –ø–æ–∏—Å–∫–∞ –≤–∫–ª—é—á–∞–ª–∞ reference

```python
# –î–æ–±–∞–≤–∏–ª–∏ –ø–æ–∏—Å–∫ –≤ reference-–¥–∞–Ω–Ω—ã—Ö
if search_reference:
    if hasattr(self, 'reference_data') and self.reference_data and current_key in self.reference_data:
        # –ò—â–µ–º –≤ –æ—Ç–¥–µ–ª—å–Ω–æ–º —Ñ–∞–π–ª–µ reference
        reference_parts = self.reference_data[current_key]
        reference_text = str(''.join(reference_parts)).lower()
        if text_lower in reference_text and text_lower not in original:
            self.search_matches.append(i)
            self.search_match_types.append('text_reference')
```

---

## üîó –ü–æ–ª–Ω—ã–π –ø–æ—Ç–æ–∫ (–≠—Ç–∞–ø 4)

```
1. –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –≤–≤–æ–¥–∏—Ç —Ç–µ–∫—Å—Ç –≤ –ø–æ–ª–µ –ø–æ–∏—Å–∫–∞
                ‚Üì
2. on_search_text_changed() –≤—ã–∑—ã–≤–∞–µ—Ç—Å—è
                ‚Üì
3. –ü—Ä–æ–≤–µ—Ä—è–µ–º —Å–æ—Å—Ç–æ—è–Ω–∏–µ —á–µ–∫–±–æ–∫—Å–æ–≤ (search_original, search_reference, search_editor)
                ‚Üì
4. –î–ª—è –∫–∞–∂–¥–æ–π —Å—Ç—Ä–æ–∫–∏:
   - –ü—Ä–æ–≤–µ—Ä—è–µ–º —Å–æ–≤–ø–∞–¥–µ–Ω–∏–µ –≤ –æ—Ä–∏–≥–∏–Ω–∞–ª–µ ‚Üí –¥–æ–±–∞–≤–ª—è–µ–º 'text_original'
   - –ü—Ä–æ–≤–µ—Ä—è–µ–º —Å–æ–≤–ø–∞–¥–µ–Ω–∏–µ –≤ –ø–µ—Ä–µ–≤–æ–¥–µ ‚Üí –¥–æ–±–∞–≤–ª—è–µ–º 'text_translated'
   - –ü—Ä–æ–≤–µ—Ä—è–µ–º —Å–æ–≤–ø–∞–¥–µ–Ω–∏–µ –≤ reference ‚Üí –¥–æ–±–∞–≤–ª—è–µ–º 'text_reference'
   - –ü—Ä–æ–≤–µ—Ä—è–µ–º —Å–æ–≤–ø–∞–¥–µ–Ω–∏–µ –≤ –∞—É–¥–∏–æ ‚Üí –¥–æ–±–∞–≤–ª—è–µ–º 'audio'
                ‚Üì
5. –°–æ—Ä—Ç–∏—Ä—É–µ–º —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã –ø–æ –∏–Ω–¥–µ–∫—Å—É —Å—Ç—Ä–æ–∫–∏
                ‚Üì
6. –í—ã–∑—ã–≤–∞–µ–º highlight_search_match(–ø–µ—Ä–≤–æ–µ_—Å–æ–≤–ø–∞–¥–µ–Ω–∏–µ)
                ‚Üì
7. highlight_search_match() –≤—ã–∑—ã–≤–∞–µ—Ç sync_editors_to_line(match_type)
                ‚Üì
8. sync_editors_to_line() –Ω–∞—Ö–æ–¥–∏—Ç –í–°–ï PreviewTextEdit –≤ –≥—Ä—É–ø–ø–µ
                ‚Üì
9. –î–ª—è –∫–∞–∂–¥–æ–≥–æ PreviewTextEdit:
   - –ü—Ä–æ–≤–µ—Ä—è–µ–º is_reference –º–∞—Ä–∫–µ—Ä
   - –ü—Ä–æ–≤–µ—Ä—è–µ–º –∏–Ω–¥–µ–∫—Å (–∏–ª–∏ -1 –¥–ª—è reference —Ñ–∞–π–ª–∞)
   - –ï—Å–ª–∏ —É—Å–ª–æ–≤–∏–µ —Å–æ–≤–ø–∞–¥–∞–µ—Ç ‚Üí –≤—ã–¥–µ–ª—è–µ–º –Ω–∞–π–¥–µ–Ω–Ω—ã–π —Ç–µ–∫—Å—Ç —á–µ—Ä–µ–∑ setExtraSelections()
```

---

## üìå –ö–ª—é—á–µ–≤—ã–µ —É—Ä–æ–∫–∏ –¥–ª—è –¥—Ä—É–≥–∏—Ö —Ä–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫–æ–≤/–ò–ò

### 1. **–ü—Ä–∏–Ω—Ü–∏–ø —è–≤–Ω–æ—Å—Ç–∏ –ª—É—á—à–µ –Ω–µ—è–≤–Ω–æ—Å—Ç–∏**
```python
# ‚ùå –ü–æ–ª–∞–≥–∞–π—Ç–µ—Å—å –Ω–∞ isReadOnly()
if edit.isReadOnly():
    ...

# ‚úÖ –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ —è–≤–Ω—ã–µ –º–∞—Ä–∫–µ—Ä—ã/—Ñ–ª–∞–≥–∏
if getattr(edit, 'is_reference', False):
    ...
```

**–ü–æ—á–µ–º—É:** –Ø–≤–Ω—ã–µ –º–∞—Ä–∫–µ—Ä—ã –º–æ–∂–Ω–æ –Ω–∞–¥—ë–∂–Ω–æ —É—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –ø—Ä–∏ —Å–æ–∑–¥–∞–Ω–∏–∏ –æ–±—ä–µ–∫—Ç–∞ –∏ –Ω–µ –∑–∞–≤–∏—Å–µ—Ç—å –æ—Ç –º–µ—Ç–æ–¥–æ–≤ –∫–ª–∞—Å—Å–∞.

### 2. **–û–±—Ä–∞–±–æ—Ç—å—Ç–µ –≤—Å–µ –≥—Ä–∞–Ω–∏—á–Ω—ã–µ —Å–ª—É—á–∞–∏**
```python
# ‚ùå –¢–æ–ª—å–∫–æ –æ—Å–Ω–æ–≤–Ω–æ–π —Å–ª—É—á–∞–π
if edit_index == line_index:
    ...

# ‚úÖ –í–∫–ª—é—á–∏—Ç–µ –≥—Ä–∞–Ω–∏—á–Ω—ã–µ —Å–ª—É—á–∞–∏
if edit_index == line_index or edit_index == -1:
    ...
```

**–ü–æ—á–µ–º—É:** –í –Ω–∞—à–µ–º —Å–ª—É—á–∞–µ reference —Ñ–∞–π–ª—ã –∏—Å–ø–æ–ª—å–∑—É—é—Ç –∏–Ω–¥–µ–∫—Å -1 –≤–º–µ—Å—Ç–æ —Ä–µ–∞–ª—å–Ω–æ–≥–æ line_index. –≠—Ç–æ –≥—Ä–∞–Ω–∏—á–Ω—ã–π —Å–ª—É—á–∞–π, –∫–æ—Ç–æ—Ä—ã–π –ª–µ–≥–∫–æ –∑–∞–±—ã—Ç—å!

### 3. **–û—Ç–¥–µ–ª–∏—Ç–µ –ª–æ–≥–∏–∫—É –ø–æ–∏—Å–∫–∞ –æ—Ç –ª–æ–≥–∏–∫–∏ –≤—ã–¥–µ–ª–µ–Ω–∏—è**
- –§—É–Ω–∫—Ü–∏—è –ø–æ–∏—Å–∫–∞ (`on_search_text_changed`) –¥–æ–ª–∂–Ω–∞ —Ç–æ–ª—å–∫–æ –∏—Å–∫–∞—Ç—å –∏ –¥–æ–±–∞–≤–ª—è—Ç—å —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã
- –§—É–Ω–∫—Ü–∏—è –≤—ã–¥–µ–ª–µ–Ω–∏—è (`sync_editors_to_line`) –¥–æ–ª–∂–Ω–∞ —Ç–æ–ª—å–∫–æ –≤—ã–¥–µ–ª—è—Ç—å
- –ù–µ —Å–º–µ—à–∏–≤–∞–π—Ç–µ —ç—Ç–∏ –ª–æ–≥–∏–∫–∏!

**–°—Ç—Ä—É–∫—Ç—É—Ä–∞:**
```python
def on_search_text_changed(text):
    # –¢–û–õ–¨–ö–û –ø–æ–∏—Å–∫
    for i, line in enumerate(lines):
        if search_text in line:
            search_matches.append(i)
            search_match_types.append('type')

def highlight_search_match(index, type):
    # –¢–û–õ–¨–ö–û –≤—ã–¥–µ–ª–µ–Ω–∏–µ
    sync_editors_to_line(index, type)

def sync_editors_to_line(index, type):
    # –¢–û–õ–¨–ö–û —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è UI
    for edit in all_edits:
        if should_highlight(edit, type, index):
            highlight_in_editor(edit)
```

### 4. **–ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ —Ç–∏–ø—ã —Å–æ–≤–ø–∞–¥–µ–Ω–∏–π –¥–ª—è –≥–∏–±–∫–æ—Å—Ç–∏**
```python
# –í–º–µ—Å—Ç–æ –æ–¥–Ω–æ–≥–æ —Ç–∏–ø–∞ 'found', –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ —Ä–∞–∑–Ω—ã–µ:
self.search_match_types.append('text_original')    # –æ—Ä–∏–≥–∏–Ω–∞–ª
self.search_match_types.append('text_translated')  # –ø–µ—Ä–µ–≤–æ–¥
self.search_match_types.append('text_reference')   # —Ä–µ—Ñ–µ—Ä–µ–Ω—Å
self.search_match_types.append('audio')            # –∞—É–¥–∏–æ—Ñ–∞–π–ª—ã

# –¢–∞–∫ –≤—ã —Å–º–æ–∂–µ—Ç–µ –≤—ã–¥–µ–ª—è—Ç—å —Ä–∞–∑–Ω—ã–µ —á–∞—Å—Ç–∏ UI –≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç —Ç–∏–ø–∞
```

**–ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞:**
- –õ–µ–≥—á–µ –¥–æ–±–∞–≤–∏—Ç—å –Ω–æ–≤—ã–µ —Ç–∏–ø—ã –ø–æ–∏—Å–∫–∞
- –ö–∞–∂–¥—ã–π —Ç–∏–ø –º–æ–∂–µ—Ç –∏–º–µ—Ç—å —É–Ω–∏–∫–∞–ª—å–Ω—É—é –ª–æ–≥–∏–∫—É –≤—ã–¥–µ–ª–µ–Ω–∏—è
- –ö–æ–¥ –æ—Å—Ç–∞—ë—Ç—Å—è —Ä–∞—Å—à–∏—Ä—è–µ–º—ã–º

### 5. **–ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä—É–π—Ç–µ –≤—Å–µ –≤–∏–¥–∂–µ—Ç—ã –æ–¥–∏–Ω–∞–∫–æ–≤–æ**
```python
# ‚ùå –ó–∞–±—ã–ª–∏ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞—Ç—å –Ω–æ–≤—ã–µ –≤–∏–¥–∂–µ—Ç—ã
new_trans = PreviewTextEdit(new_index, text, read_only=False)

# ‚úÖ –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä—É–π—Ç–µ –≤—Å–µ –º–µ—Ç–∞–¥–∞–Ω–Ω—ã–µ
new_trans = PreviewTextEdit(new_index, text, read_only=False)
new_trans.is_reference = False  # ‚Üê –ù–µ –∑–∞–±—É–¥—å—Ç–µ!
```

**–ì–¥–µ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞—Ç—å:**
- –ü—Ä–∏ —Å–æ–∑–¥–∞–Ω–∏–∏ –≤–∏–¥–∂–µ—Ç–∞ –≤ –æ—Å–Ω–æ–≤–Ω–æ–º –∫–æ–¥–µ
- –ü—Ä–∏ –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–æ–º –¥–æ–±–∞–≤–ª–µ–Ω–∏–∏ –Ω–æ–≤—ã—Ö —ç–ª–µ–º–µ–Ω—Ç–æ–≤
- –ü—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ –¥–∞–Ω–Ω—ã—Ö –∏–∑ —Ñ–∞–π–ª–æ–≤

### 6. **–õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –ø–æ–º–æ–≥–∞–µ—Ç –Ω–∞–π—Ç–∏ –æ—à–∏–±–∫–∏**
```python
# –î–æ–±–∞–≤—å—Ç–µ print() –¥–ª—è –æ—Ç–ª–∞–¥–∫–∏ (—É–¥–∞–ª–∏—Ç–µ –ø–æ—Ç–æ–º):
print(f"DEBUG: is_reference={is_reference}, edit_index={edit_index}, line_index={line_index}")
print(f"DEBUG: should_search={should_search}, match found at pos {pos}")

# –≠—Ç–æ –ø–æ–º–æ–∂–µ—Ç –±—ã—Å—Ç—Ä–æ –Ω–∞–π—Ç–∏ –ª–æ–≥–∏—á–µ—Å–∫–∏–µ –æ—à–∏–±–∫–∏
```

**–ö–∞–∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å:**
1. –î–æ–±–∞–≤—å—Ç–µ print –ø–µ—Ä–µ–¥ –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏–º–∏ –≤–µ—Ç–≤–ª–µ–Ω–∏—è–º–∏
2. –ó–∞–ø—É—Å—Ç–∏—Ç–µ –ø—Ä–æ–≥—Ä–∞–º–º—É –∏ –ø—Ä–æ–≤–µ—Ä—å—Ç–µ –∫–æ–Ω—Å–æ–ª—å
3. –ü–æ—Å–º–æ—Ç—Ä–∏—Ç–µ, –∫–∞–∫–∏–µ –∑–Ω–∞—á–µ–Ω–∏—è –Ω–µ —Å–æ–≤–ø–∞–¥–∞—é—Ç —Å –æ–∂–∏–¥–∞–Ω–∏—è–º–∏
4. –£–¥–∞–ª–∏—Ç–µ print –∏–ª–∏ –∑–∞–º–µ–Ω–∏—Ç–µ –Ω–∞ logger

### 7. **–¢–µ—Å—Ç–∏—Ä—É–π—Ç–µ –≥—Ä–∞–Ω–∏—á–Ω—ã–µ —Å–ª—É—á–∞–∏**
```python
# –¢–µ—Å—Ç—ã –¥–ª—è –≥—Ä–∞–Ω–∏—á–Ω—ã—Ö —Å–ª—É—á–∞–µ–≤:
test_case_1 = "–°–æ–≤–ø–∞–¥–µ–Ω–∏–µ –≤ –Ω–∞—á–∞–ª–µ"
test_case_2 = "–°–æ–≤–ø–∞–¥–µ–Ω–∏–µ –≤ –∫–æ–Ω—Ü–µ"
test_case_3 = "–°–æ–≤–ø–∞–¥–µ–Ω–∏–µ –≤ –ºIDdle"
test_case_4 = "–ù–µ—Ç —Å–æ–≤–ø–∞–¥–µ–Ω–∏–π"
test_case_5 = "MULTIPLE —Å–æ–≤–ø–∞–¥–µ–Ω–∏—è –≤ MULTIPLE –º–µ—Å—Ç–∞—Ö"
test_case_6 = "–ü—É—Å—Ç–æ–π search_text"
test_case_7 = "–û—á–µ–Ω—å –¥–ª–∏–Ω–Ω—ã–π —Ç–µ–∫—Å—Ç —Å –æ—á–µ–Ω—å –º–Ω–æ–≥–æ —Å–∏–º–≤–æ–ª–æ–≤"
```

---

## üìä –†–µ–∑—É–ª—å—Ç–∞—Ç

```
–î–û –ò–°–ü–†–ê–í–õ–ï–ù–ò–Ø:
‚îú‚îÄ –û—Ä–∏–≥–∏–Ω–∞–ª ‚úÖ –í—ã–¥–µ–ª—è–µ—Ç—Å—è
‚îú‚îÄ Editor ‚úÖ –í—ã–¥–µ–ª—è–µ—Ç—Å—è  
‚îú‚îÄ –†–µ—Ñ–µ—Ä–µ–Ω—Å ‚ùå –ù–ï –≤—ã–¥–µ–ª—è–µ—Ç—Å—è (–≥–ª–∞–≤–Ω–∞—è –ø—Ä–æ–±–ª–µ–º–∞!)
‚îî‚îÄ –ê—É–¥–∏–æ ‚úÖ –í—ã–¥–µ–ª—è–µ—Ç—Å—è

–ü–û–°–õ–ï –ò–°–ü–†–ê–í–õ–ï–ù–ò–Ø:
‚îú‚îÄ –û—Ä–∏–≥–∏–Ω–∞–ª ‚úÖ –í—ã–¥–µ–ª—è–µ—Ç—Å—è
‚îú‚îÄ Editor ‚úÖ –í—ã–¥–µ–ª—è–µ—Ç—Å—è
‚îú‚îÄ –†–µ—Ñ–µ—Ä–µ–Ω—Å ‚úÖ –í—ã–¥–µ–ª—è–µ—Ç—Å—è (–†–ï–®–ï–ù–û!)
‚îî‚îÄ –ê—É–¥–∏–æ ‚úÖ –í—ã–¥–µ–ª—è–µ—Ç—Å—è
```

---

## üéì –ü—Ä–∏–º–µ–Ω–∏–º–æ—Å—Ç—å –∫ –¥—Ä—É–≥–∏–º –ø—Ä–æ–µ–∫—Ç–∞–º

–≠—Ç–∞ —Ç–µ—Ö–Ω–∏–∫–∞ —Ä–∞–±–æ—Ç–∞–µ—Ç –¥–ª—è –ª—é–±–æ–≥–æ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è —Å **–Ω–µ—Å–∫–æ–ª—å–∫–∏–º–∏ —Å—Ç–æ–ª–±—Ü–∞–º–∏/–ø–∞–Ω–µ–ª—è–º–∏**, –≥–¥–µ –Ω—É–∂–Ω–æ:
- –°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∏—Ä–æ–≤–∞—Ç—å –ø–æ–∏—Å–∫/–≤—ã–¥–µ–ª–µ–Ω–∏–µ
- –û–±—Ä–∞–±–æ—Ç–∞—Ç—å —Ä–∞–∑–Ω—ã–µ —Ç–∏–ø—ã –¥–∞–Ω–Ω—ã—Ö
- –£–ø—Ä–∞–≤–ª—è—Ç—å —Å–æ—Å—Ç–æ—è–Ω–∏–µ–º read-only/editable –≤–∏–¥–∂–µ—Ç–æ–≤

**–ü—Ä–∏–º–µ—Ä—ã:** 
- –ú–µ–¥–∏–∞—Ä–µ–¥–∞–∫—Ç–æ—Ä—ã (–≤–∏–¥–µ–æ, –∞—É–¥–∏–æ)
- IDE —Å multiple panes (VS Code, PyCharm)
- –¢–∞–±–ª–∏—á–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ –∏ spreadsheets
- –ü–∞—Ä–∞–ª–ª–µ–ª—å–Ω—ã–µ —Ç–µ–∫—Å—Ç-–ø–µ—Ä–µ–≤–æ–¥—ã (Google Translate, CAT tools)
- –†–µ–∂–∏–º—ã preview/edit
- Split view –≤ —Ç–µ–∫—Å—Ç–æ–≤—ã—Ö —Ä–µ–¥–∞–∫—Ç–æ—Ä–∞—Ö

---

## üîß –ü—Ä–∞–∫—Ç–∏—á–µ—Å–∫–∏–µ —Å–æ–≤–µ—Ç—ã –¥–ª—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏

### –ö–æ–≥–¥–∞ –¥–æ–±–∞–≤–ª—è–µ—Ç–µ –Ω–æ–≤—É—é –æ–±–ª–∞—Å—Ç—å –ø–æ–∏—Å–∫–∞:

1. **–î–æ–±–∞–≤—å—Ç–µ –Ω–æ–≤—ã–π —Ç–∏–ø —Å–æ–≤–ø–∞–¥–µ–Ω–∏—è**
   ```python
   self.search_match_types.append('new_search_type')
   ```

2. **–î–æ–±–∞–≤—å—Ç–µ –ª–æ–≥–∏–∫—É –ø–æ–∏—Å–∫–∞ –≤ `on_search_text_changed`**
   ```python
   if search_new_area:
       if text_lower in new_area_text:
           self.search_matches.append(i)
           self.search_match_types.append('new_search_type')
   ```

3. **–î–æ–±–∞–≤—å—Ç–µ –æ–±—Ä–∞–±–æ—Ç–∫—É –≤—ã–¥–µ–ª–µ–Ω–∏—è –≤ `sync_editors_to_line`**
   ```python
   if match_type == 'new_search_type':
       should_search = is_new_area_widget and correct_index
   ```

4. **–¢–µ—Å—Ç–∏—Ä—É–π—Ç–µ –∫–∞–∂–¥—ã–π —à–∞–≥** –ø–µ—Ä–µ–¥ –ø–µ—Ä–µ—Ö–æ–¥–æ–º –∫ —Å–ª–µ–¥—É—é—â–µ–º—É

### –û—Ç–ª–∞–¥–∫–∞:

–ï—Å–ª–∏ –≤—ã–¥–µ–ª–µ–Ω–∏–µ –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç:
1. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ, —á—Ç–æ –ø–æ–∏—Å–∫ –Ω–∞—Ö–æ–¥–∏—Ç —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã (–¥–æ–±–∞–≤—å—Ç–µ print –≤ `on_search_text_changed`)
2. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ, —á—Ç–æ `sync_editors_to_line` –≤—ã–∑—ã–≤–∞–µ—Ç—Å—è (–¥–æ–±–∞–≤—å—Ç–µ print –≤ `highlight_search_match`)
3. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –º–∞—Ä–∫–µ—Ä—ã –≤–∏–¥–∂–µ—Ç–æ–≤ (is_reference, –∏–Ω–¥–µ–∫—Å—ã)
4. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —É—Å–ª–æ–≤–∏–µ `should_search`
5. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ, —á—Ç–æ `setExtraSelections()` –≤—ã–∑—ã–≤–∞–µ—Ç—Å—è

---

## üìö –§–∞–π–ª—ã, –∫–æ—Ç–æ—Ä—ã–µ –±—ã–ª–∏ –∏–∑–º–µ–Ω–µ–Ω—ã

1. **main.py**
   - `on_search_text_changed()` - –¥–æ–±–∞–≤–ª–µ–Ω–∞ –ª–æ–≥–∏–∫–∞ –ø–æ–∏—Å–∫–∞ –≤ reference
   - `highlight_search_match()` - –¥–æ–±–∞–≤–ª–µ–Ω–∞ –æ–±—Ä–∞–±–æ—Ç–∫–∞ text_reference
   - `sync_editors_to_line()` - –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∞ –ª–æ–≥–∏–∫–∞ –≤—ã–¥–µ–ª–µ–Ω–∏—è
   - –°–æ–∑–¥–∞–Ω–∏–µ PreviewTextEdit - –¥–æ–±–∞–≤–ª–µ–Ω—ã –º–∞—Ä–∫–µ—Ä—ã is_reference

2. **dialogs.py**
   - `SettingsWindow.__init__()` - –¥–æ–±–∞–≤–ª–µ–Ω—ã —á–µ–∫–±–æ–∫—Å—ã –¥–ª—è –≤—ã–±–æ—Ä–∞ –æ–±–ª–∞—Å—Ç–µ–π –ø–æ–∏—Å–∫–∞
   - –ü–æ–¥–∫–ª—é—á–µ–Ω—ã —Å–∏–≥–Ω–∞–ª—ã —á–µ–∫–±–æ–∫—Å–æ–≤

3. **widgets.py**
   - `SearchAreaCheckBox` - —É–ª—É—á—à–µ–Ω —Ä–∞–∑–º–µ—Ä –∏ –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ

4. **localization.py**
   - –î–æ–±–∞–≤–ª–µ–Ω—ã –∫–ª—é—á–∏ –ª–æ–∫–∞–ª–∏–∑–∞—Ü–∏–∏ –¥–ª—è –æ–±–ª–∞—Å—Ç–µ–π –ø–æ–∏—Å–∫–∞

---

## ‚ùì –ß–∞—Å—Ç–æ –∑–∞–¥–∞–≤–∞–µ–º—ã–µ –≤–æ–ø—Ä–æ—Å—ã

**–í: –ü–æ—á–µ–º—É –∏–Ω–¥–µ–∫—Å -1 –¥–ª—è reference —Ñ–∞–π–ª–æ–≤?**
–û: –ü–æ—Ç–æ–º—É —á—Ç–æ reference —Ñ–∞–π–ª –º–æ–∂–µ—Ç —Å–æ–¥–µ—Ä–∂–∞—Ç—å –Ω–µ—Å–∫–æ–ª—å–∫–æ —á–∞—Å—Ç–µ–π (–µ—Å–ª–∏ –∫–ª—é—á —Ä–∞–∑–±–∏—Ç), –∏ —Å–∏—Å—Ç–µ–º–∞ –Ω—É–º–µ—Ä—É–µ—Ç –∏—Ö —Å –ø–æ–º–æ—â—å—é -1 –¥–ª—è –æ–±–æ–∑–Ω–∞—á–µ–Ω–∏—è "—ç—Ç–æ –∏–∑ –æ—Ç–¥–µ–ª—å–Ω–æ–≥–æ —Ñ–∞–π–ª–∞".

**–í: –ú–æ–∂–Ω–æ –ª–∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å isReadOnly() –≤–º–µ—Å—Ç–æ is_reference?**
–û: –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏ –¥–∞, –Ω–æ `is_reference` –≤ 100% —Å–ª—É—á–∞–µ–≤ –±—É–¥–µ—Ç –ø—Ä–∞–≤–∏–ª—å–Ω—ã–º, —Ç–∞–∫ –∫–∞–∫ —ç—Ç–æ —è–≤–Ω–æ–µ –Ω–∞–∑–Ω–∞—á–µ–Ω–∏–µ. `isReadOnly()` –º–æ–∂–µ—Ç –∑–∞–≤–∏—Å–µ—Ç—å –æ—Ç –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞.

**–í: –ß—Ç–æ –¥–µ–ª–∞—Ç—å, –µ—Å–ª–∏ –Ω–æ–≤—ã–π —Ç–∏–ø —Å–æ–≤–ø–∞–¥–µ–Ω–∏—è –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω–æ –≤—ã–¥–µ–ª—è–µ—Ç—Å—è?**
–û: –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –≥—Ä–∞–Ω–∏—á–Ω—ã–µ —Å–ª—É—á–∞–∏ (–∏–Ω–¥–µ–∫—Å—ã -1, –ø—É—Å—Ç—ã–µ —Å—Ç—Ä–æ–∫–∏) –∏ —É—Å–ª–æ–≤–∏—è –≤ `sync_editors_to_line`.

**–í: –ö–∞–∫ –¥–æ–±–∞–≤–∏—Ç—å —Ñ–∏–ª—å—Ç—Ä –¥–ª—è –º–Ω–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω—ã—Ö —Å–æ–≤–ø–∞–¥–µ–Ω–∏–π –≤ –æ–¥–Ω–æ–π —Å—Ç—Ä–æ–∫–µ?**
–û: –ò–∑–º–µ–Ω–∏—Ç–µ –ª–æ–≥–∏–∫—É –≤ `sync_editors_to_line` —á—Ç–æ–±—ã –∏—Å–∫–∞—Ç—å –í–°–ï –≤—Ö–æ–∂–¥–µ–Ω–∏—è, –∞ –Ω–µ –ø–µ—Ä–≤–æ–µ:
```python
pos = 0
while pos < len(doc_text):
    pos = doc_text_lower.find(search_text_lower, pos)
    if pos >= 0:
        # –î–æ–±–∞–≤—å—Ç–µ –≤—ã–¥–µ–ª–µ–Ω–∏–µ –¥–ª—è —ç—Ç–æ–≥–æ –≤—Ö–æ–∂–¥–µ–Ω–∏—è
        pos += len(search_text)
    else:
        break
```

---

**–°–æ–∑–¥–∞–Ω–æ: 27 —Ñ–µ–≤—Ä–∞–ª—è 2026**
**–í–µ—Ä—Å–∏—è: 1.0**
**–ê–≤—Ç–æ—Ä: –†–µ—à–µ–Ω–∏–µ –¥–ª—è DCS Translation TOOL**
